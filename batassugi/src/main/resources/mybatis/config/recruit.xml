<?xml version="1.0" encoding="UTF-8"?>
<!-- Sql Mapper -->
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="recruit">
  <insert id="registerRecruit" parameterType="recruitVo">
    insert into recruit 
    values(recruit_seq.nextval, #{farmVo.farmNo}, #{recruitKind}, 
    sysdate, #{recruitEnddate}, #{price}, #{recruitContent}, '모집중', #{recruitSize})
  </insert>
  
  <select id="findRestFarmSizeByFarmNo" parameterType="string" resultType="string">
    select (farm_size-(select coalesce(sum(r.rent_size),0) from rent r, recruit c, farm f 
    where c.recruit_no=r.recruit_no and c.farm_no=f.farm_no and f.farm_no=#{farmNo})-(
    select coalesce(sum(recruit_size),0) from recruit where farm_no=#{farmNo}))
    from farm
    where farm_no=#{farmNo}
  </select>
  
  <select id="findMaxRecruitMonth" parameterType="string" resultType="string">
    select ROUND(MONTHS_BETWEEN(farm_enddate,sysdate)) AS maxRentMonth from farm
    where farm_no=#{farmNo}
  </select>
</mapper>
 <!--
 CREATE TABLE recruit
(
    recruit_no           NUMBER          NOT NULL, 
    farm_no              NUMBER          NOT NULL, 
    recruit_kind         VARCHAR2(50)    NOT NULL, 
    recruit_startdate    DATE            NOT NULL, 
    recruit_enddate      DATE            NOT NULL, 
    price                NUMBER          NOT NULL, 
    recruit_content      CLOB            NOT NULL, 
    recruit_status       VARCHAR2(50)    NOT NULL, 
    recruit_size         NUMBER          NOT NULL,  
  -->
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
















